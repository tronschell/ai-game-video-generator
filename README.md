# 🎮 Game Highlight Generator

<div align="center">

![Version](https://img.shields.io/badge/version-1.0-blue)
![Python](https://img.shields.io/badge/python-3.8+-brightgreen)

</div>

> AI-powered highlight generator for Counter-Strike 2 that automatically identifies and compiles your best gameplay moments using Google's Gemini AI.

<p align="center">
  <img src="https://img.shields.io/badge/Powered%20by-Gemini%20AI-blue?style=for-the-badge&logo=google&logoColor=white" alt="Powered by Gemini AI">
</p>

## ✨ Key Features

| Feature | Description |
|---------|-------------|
| 🤖 **Smart Detection** | Uses Gemini Flash/Pro models to identify clutch moments, multi-kills, and emotional reactions |
| ⚡ **Parallel Processing** | Efficiently analyzes multiple clips concurrently |
| 🎬 **Auto Compilation** | Creates a single, well-edited highlight video |
| 🔍 **Smart Filtering** | Only includes highlights from your gameplay (configurable username) |
| 🧠 **Context Awareness** | Understands game state and round context for meaningful clips |
| 🧹 **Auto Resource Management** | Handles temp files and API resources efficiently |
| 🔄 **Duplicate Prevention** | Tracks previously used clips to avoid repetition |
|💸**Price & Token Monitoring**|Exports a `token_costs.csv` file with token usage + pricing calculation based on model name used in config.json|

## 📋 Prerequisites

- Python 3.8+
- FFmpeg (installed and in PATH)
- Google API key for Gemini AI
- Gameplay recordings (optimized for CS2, works with other games)

## 🚀 Quick Start

### Installation

```bash
# Clone the repository
git clone <repository-url>
cd ai-game-video-generator

# Set up virtual environment
python -m venv .venv

# Activate virtual environment
# Windows
.venv\Scripts\activate
# Linux/Mac
source .venv/bin/activate

# Install dependencies
pip install -e .

# Configure API key
echo "GOOGLE_API_KEY=your_gemini_api_key_here" > .env
```

### Basic Usage

```bash
python main.py "/path/to/clips/folder"
```

The generator will:
1. Process up to 25 recent video clips (configurable)
2. Intelligently identify highlight-worthy moments
3. Skip any previously used clips
4. Create a compilation with your best moments

## 📂 Project Structure

```
.
├── pyproject.toml         # Project metadata and dependencies
├── config.json           # Configuration settings
├── src/
│   ├── main.py          # Entry point script
│   ├── video_analysis.py   # Gemini AI video analysis
│   ├── video_concatenator.py # Clip compilation
│   ├── prompts.py         # Analysis prompt templates
│   ├── delete_files.py    # Cleanup utilities
│   ├── logging_config.py  # Logging setup
│   ├── exported_videos/   # Final highlight compilations
│   ├── logs/             # Log files
│   ├── temp_segments/    # Temporary processing files
│   └── token_costs.csv   # Token usage and cost tracking
```

## ⚙️ Configuration

Edit `config.json` to customize behavior:

```json
{
  "batch_size": 10,
  "model_name": "gemini-2.5-flash-preview-04-17",
  "max_retries": 14,
  "retry_delay_seconds": 2,
  "min_highlight_duration_seconds": 15,
  "username": "{YOUR USERNAME}",
  "max_clips": 25,
  "allow_clip_reuse": false,
  "temperature": 1,
  "use_caching": false,
  "cache_ttl_seconds": 3600,
  "skip_videos": 60
}
```

## 🛠️ Advanced Usage

### Gemini Models
The following models are available for highlight detection:

| Model | Price | Performance | Recommendation |
|-------|--------|-------------|----------------|
| `gemini-2.5-flash-preview-04-17` | About $0.10 per 25 video clips at 1 minute each with audio. | Fast analysis, good accuracy | Best for most users |
| `gemini-2.5-pro-preview-05-06` |  About $0.80 per 25 video clips at 1 minute each with audio| *About* 20% better video highlighting, slower | For highest quality detection |


The default model (gemini-2.5-flash-preview-04-17) provides a good balance of speed and accuracy. Change the `model_name` in config.json to use a different model.


### Customizing Highlight Detection

The analysis prompts in `src/prompts.py` can be customized to define:

- Different highlight criteria for your specific game
- Custom timestamp formats
- Game-specific detection rules

### Output Files

| File | Purpose |
|------|---------|
| `src/highlights.json` | Metadata generated by Gemini about detected highlights |
| `src/used_clips.json` | History of previously used clips |
| `exported_videos/highlights_[timestamp].mp4` | Final compiled highlight video |
| `logs/*.log` | Detailed operation logs |

## 📝 Important Notes

- Videos should be encoded in h246 in MP4 format for Gemini AI compatibility
- Default username for highlight detection is "{YOUR USERNAME HERE}"" (configurable)
- Kill feed entries with thin red outlines are included in analysis for Counter Strike 2
- Previously used clips are tracked to prevent duplicates

## 🤝 Contributing

Contributions are welcome! Feel free to submit issues, fork the repository, and create pull requests.

---

<div align="center">
  Made with ❤️ for gamers who want to showcase their best moments
</div>
